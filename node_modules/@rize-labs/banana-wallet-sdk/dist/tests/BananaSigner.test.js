'use strict';var _0x381bdd=_0x56fc;function _0x56fc(_0x1a12ec,_0xd62980){var _0x5e8a43=_0x5e8a();return _0x56fc=function(_0x56fc61,_0x46d3fb){_0x56fc61=_0x56fc61-0x147;var _0x406cce=_0x5e8a43[_0x56fc61];return _0x406cce;},_0x56fc(_0x1a12ec,_0xd62980);}(function(_0x40b00b,_0x4f9f1f){var _0x212e28=_0x56fc,_0x198d25=_0x40b00b();while(!![]){try{var _0x37b402=parseInt(_0x212e28(0x14e))/0x1*(parseInt(_0x212e28(0x159))/0x2)+-parseInt(_0x212e28(0x177))/0x3+-parseInt(_0x212e28(0x149))/0x4+-parseInt(_0x212e28(0x17e))/0x5+parseInt(_0x212e28(0x148))/0x6+parseInt(_0x212e28(0x166))/0x7+-parseInt(_0x212e28(0x15b))/0x8*(-parseInt(_0x212e28(0x171))/0x9);if(_0x37b402===_0x4f9f1f)break;else _0x198d25['push'](_0x198d25['shift']());}catch(_0x11a6c4){_0x198d25['push'](_0x198d25['shift']());}}}(_0x5e8a,0xb2b36));Object[_0x381bdd(0x152)](exports,_0x381bdd(0x175),{'value':!0x0});const _0x3885a0=require('chai'),_0x345798=require('../BananaSigner'),_0x18645e=require('@ethersproject/providers'),_0x167fbb=require('./BananaConstants'),_0x1202a0=require('@ethersproject/logger'),_0x217cbe=require('ethers'),_0x393072=require('chai'),_0x21e882=require('chai-as-promised'),_0x5cd6d6=(_0x393072[_0x381bdd(0x161)](_0x21e882),require('sinon')),_0x13ee46=require('../WebAuthnContext');function _0x5e8a(){var _0x24c638=['qjAxP','encoded\x20ID\x20not\x20provided','UNSUPPORTED_OPERATION','throw','sSfWs','computes\x20correct\x20address\x20based\x20on\x20public\x20keys\x20of\x20signer','6662805Nolawu','slice','QdGkv','firstCall','eljwq','utils','reverts\x20if\x20verifyFingerPrint\x20returns\x20error','stub','Logger','signing\x20transactions\x20is\x20unsupported','BwYHf','equal','encodedId','returns\x20signedUserOp','bHfVa','5367516NXoATf','3403164VHZqPI','error\x20in\x20signing\x20message','reverts\x20when\x20called','0x1234','reset','1879SvfzdP','args','reverts\x20if\x20encodedId\x20is\x20not\x20provided','awKds','defineProperty','deep','verifyFingerprint','ZyVDo','rejectedWith','expect','JUNK_ID','86vnIhEY','signMessage','3179944sScpYU','signTransaction','rejects','JsonRpcProvider','cLiPT','calls\x20verifyFingerprint\x20with\x20correct\x20parameters','use','tcuJQ','JUNK_HASH','KiTks','signUserOp','1633807AcFmgy','returns\x20signed\x20message','dZGYZ','DUMMY_Q0','Verification\x20failed','jmKpm','signature','Ejbmd','cannot\x20alter\x20JSON-RPC\x20Signer\x20connection','DUMMY_URL','BananaSigner','45eYiCAT','connect','resolves','getAddress','__esModule','0x04','842817HslAVT'];_0x5e8a=function(){return _0x24c638;};return _0x5e8a();}describe('BananaSigner',()=>{var _0x33aee3=_0x381bdd;let _0x33065f,_0x4705d0,_0x354612,_0x5da876;const _0x2edd02=()=>{var _0x441029=_0x56fc;_0x4705d0={'q0':_0x167fbb[_0x441029(0x169)],'q1':_0x167fbb['DUMMY_Q1'],'encodedId':_0x167fbb[_0x441029(0x158)]},_0x354612=new _0x18645e[(_0x441029(0x15e))](_0x167fbb[_0x441029(0x16f)]),_0x33065f=new _0x345798[(_0x441029(0x170))](_0x354612,_0x4705d0);},_0x24e39d=()=>{var _0x26ef97=_0x56fc;_0x26ef97(0x182)!==_0x26ef97(0x16d)?(_0x5da876=_0x5cd6d6['stub'](),_0x13ee46[_0x26ef97(0x154)]=_0x5da876):_0x2be46e['reset']();};describe(_0x33aee3(0x172),()=>{var _0x4f8d2c=_0x33aee3;beforeEach(()=>{var _0x2c79f6=_0x56fc;'qjAxP'===_0x2c79f6(0x178)?_0x2edd02():(_0x132f52=_0x547e26[_0x2c79f6(0x185)](),_0x50b74b['verifyFingerprint']=_0x33cf7f);}),it(_0x4f8d2c(0x14b),()=>{var _0xd55e5f=_0x4f8d2c;(0x0,_0x3885a0[_0xd55e5f(0x157)])(_0x33065f[_0xd55e5f(0x172)])['to']['be'][_0xd55e5f(0x17b)](_0xd55e5f(0x16e)),(0x0,_0x3885a0[_0xd55e5f(0x157)])(_0x33065f['connect'])['to']['be'][_0xd55e5f(0x17b)](_0x1202a0['Logger']['errors']['UNSUPPORTED_OPERATION']);});}),describe(_0x33aee3(0x174),()=>{var _0x81dc99=_0x33aee3;beforeEach(()=>{var _0x824854=_0x56fc;_0x824854(0x188)!==_0x824854(0x151)?_0x2edd02():(_0xbb9acf(),_0x388a98());}),it(_0x81dc99(0x17d),async()=>{var _0x35fd88=_0x81dc99,_0x2fc7ab=_0x35fd88(0x176)+_0x4705d0['q0'][_0x35fd88(0x17f)](0x2)+_0x4705d0['q1'][_0x35fd88(0x17f)](0x2),_0x2fc7ab=_0x217cbe['ethers'][_0x35fd88(0x183)]['computeAddress'](_0x2fc7ab),_0x4f86e2=await _0x33065f[_0x35fd88(0x174)]();(0x0,_0x3885a0[_0x35fd88(0x157)])(_0x4f86e2)['to']['be']['eq'](_0x2fc7ab);});}),describe('signTransaction',()=>{var _0x557228=_0x33aee3;beforeEach(()=>{_0x2edd02();}),it(_0x557228(0x14b),()=>{var _0x5720a9=_0x557228;(0x0,_0x3885a0[_0x5720a9(0x157)])(_0x33065f['signTransaction'])['to']['be'][_0x5720a9(0x17b)]('signing\x20transactions\x20is\x20unsupported'),(0x0,_0x3885a0[_0x5720a9(0x157)])(_0x33065f[_0x5720a9(0x15c)])['to']['be']['throw'](_0x1202a0[_0x5720a9(0x186)]['errors'][_0x5720a9(0x17a)]);});}),describe(_0x33aee3(0x15a),()=>{var _0x51ce3d=_0x33aee3;_0x51ce3d(0x180)!==_0x51ce3d(0x168)?(beforeEach(()=>{_0x2edd02(),_0x24e39d();}),afterEach(function(){var _0x5483b0=_0x51ce3d;_0x5483b0(0x17c)!==_0x5483b0(0x16b)?_0x5da876[_0x5483b0(0x14d)]():_0x5d997e[_0x5483b0(0x14d)]();}),it(_0x51ce3d(0x150),async()=>{var _0x239724=_0x51ce3d;if(_0x239724(0x162)===_0x239724(0x155))_0x5cf694(()=>{_0x58d5f8();}),_0x4cc34e('reverts\x20when\x20called',()=>{var _0x2e469c=_0x239724;(0x0,_0x415a6a['expect'])(_0x305c7e[_0x2e469c(0x15c)])['to']['be'][_0x2e469c(0x17b)](_0x2e469c(0x187)),(0x0,_0x3a06c4[_0x2e469c(0x157)])(_0x2a9f19[_0x2e469c(0x15c)])['to']['be'][_0x2e469c(0x17b)](_0x50b4df[_0x2e469c(0x186)]['errors'][_0x2e469c(0x17a)]);});else{var _0x1ea798=_0x167fbb[_0x239724(0x163)];await(0x0,_0x3885a0['expect'])(_0x33065f['signMessage'](_0x1ea798))['to']['be'][_0x239724(0x156)](_0x239724(0x179));}}),it('reverts\x20if\x20verifyFingerprint\x20reverts',async()=>{var _0x1fc579=_0x51ce3d,_0x2f2de3=_0x167fbb[_0x1fc579(0x163)],_0x146928=_0x167fbb[_0x1fc579(0x158)],_0x2424ce=new Error('error\x20in\x20signing\x20message');_0x5da876[_0x1fc579(0x15d)](_0x2424ce),await(0x0,_0x3885a0[_0x1fc579(0x157)])(_0x33065f[_0x1fc579(0x15a)](_0x2f2de3,_0x146928))['to']['be']['rejectedWith'](_0x1fc579(0x14a));}),it(_0x51ce3d(0x160),async()=>{var _0x59198e=_0x51ce3d;if(_0x59198e(0x15f)!==_0x59198e(0x15f))_0x18e54b();else{var _0x379a42=_0x167fbb['JUNK_HASH'],_0x2a0d34=_0x167fbb['JUNK_ID'],_0x186a24={'signature':'0x1234'};_0x5da876[_0x59198e(0x173)]({'newUserOp':_0x186a24,'process':!0x0}),await _0x33065f['signMessage'](_0x379a42,_0x2a0d34),(0x0,_0x3885a0[_0x59198e(0x157)])(_0x5da876[_0x59198e(0x181)][_0x59198e(0x14f)][0x0])['to']['be'][_0x59198e(0x153)][_0x59198e(0x189)]({}),(0x0,_0x3885a0[_0x59198e(0x157)])(_0x5da876[_0x59198e(0x181)][_0x59198e(0x14f)][0x1])['to']['be'][_0x59198e(0x189)](_0x379a42),(0x0,_0x3885a0[_0x59198e(0x157)])(_0x5da876[_0x59198e(0x181)]['args'][0x2])['to']['be']['equal'](_0x2a0d34);}}),it(_0x51ce3d(0x167),async()=>{var _0xf03d31=_0x51ce3d,_0x52f1e8=_0x167fbb[_0xf03d31(0x163)],_0x5dbb14=_0x167fbb[_0xf03d31(0x158)],_0x2ed80={'signature':_0xf03d31(0x14c)},_0x357bde={'newUserOp':_0x2ed80,'process':!0x0},_0x357bde=(_0x5da876[_0xf03d31(0x173)](_0x357bde),await _0x33065f['signMessage'](_0x52f1e8,_0x5dbb14));(0x0,_0x3885a0[_0xf03d31(0x157)])(_0x357bde)['to'][_0xf03d31(0x189)](_0x2ed80[_0xf03d31(0x16c)]);})):_0x1f4f83();}),describe(_0x33aee3(0x165),function(){var _0x4be52c=_0x33aee3;beforeEach(function(){var _0x3a5099=_0x56fc;_0x3a5099(0x164)===_0x3a5099(0x147)?(_0x3c120d={'q0':_0xeb0c86['DUMMY_Q0'],'q1':_0x565bf0['DUMMY_Q1'],'encodedId':_0x2b4f67[_0x3a5099(0x158)]},_0x2d5769=new _0x10ff0e[(_0x3a5099(0x15e))](_0x2e2570[_0x3a5099(0x16f)]),_0x3ecd25=new _0xf61c55[(_0x3a5099(0x170))](_0x548341,_0x55d87b)):(_0x2edd02(),_0x24e39d());}),afterEach(function(){var _0x5aff4d=_0x56fc;_0x5da876[_0x5aff4d(0x14d)]();}),it(_0x4be52c(0x184),async function(){var _0x3d1aaa=_0x4be52c,_0x30bacd={},_0x4625f8=new Error(_0x3d1aaa(0x16a)),_0x30bacd=(_0x5da876[_0x3d1aaa(0x173)](_0x4625f8),await _0x33065f[_0x3d1aaa(0x165)](_0x30bacd,'requestId','encodedId'));(0x0,_0x3885a0[_0x3d1aaa(0x157)])(_0x30bacd)['to'][_0x3d1aaa(0x189)](_0x4625f8);}),it('calls\x20verifyFingerprint\x20with\x20correct\x20parameters',async function(){var _0x4dfe3a=_0x4be52c,_0x5b0059={},_0x2ade69='requestId',_0x555653=_0x4dfe3a(0x18a);_0x5da876['resolves']({'newUserOp':_0x5b0059,'process':!0x0}),await _0x33065f[_0x4dfe3a(0x165)](_0x5b0059,_0x2ade69,_0x555653),(0x0,_0x3885a0[_0x4dfe3a(0x157)])(_0x5da876[_0x4dfe3a(0x181)][_0x4dfe3a(0x14f)][0x0])['to']['be'][_0x4dfe3a(0x189)](_0x5b0059),(0x0,_0x3885a0['expect'])(_0x5da876[_0x4dfe3a(0x181)]['args'][0x1])['to']['be']['equal'](_0x2ade69),(0x0,_0x3885a0[_0x4dfe3a(0x157)])(_0x5da876[_0x4dfe3a(0x181)]['args'][0x2])['to']['be'][_0x4dfe3a(0x189)](_0x555653);}),it(_0x4be52c(0x18b),async function(){var _0x2836bb=_0x4be52c,_0x3bca3e={},_0x3c5923={'newUserOp':_0x3bca3e,'process':!0x0},_0x3bca3e=(_0x5da876[_0x2836bb(0x173)](_0x3c5923),await _0x33065f[_0x2836bb(0x165)](_0x3bca3e,'requestId',_0x2836bb(0x18a)));(0x0,_0x3885a0[_0x2836bb(0x157)])(_0x3bca3e)['to'][_0x2836bb(0x153)][_0x2836bb(0x189)](_0x3c5923);});});});